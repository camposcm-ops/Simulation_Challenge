<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Christian Campos">

<title>Simulation Challenge - Monte Carlo Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SimulationChallenge_files/libs/clipboard/clipboard.min.js"></script>
<script src="SimulationChallenge_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="SimulationChallenge_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="SimulationChallenge_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="SimulationChallenge_files/libs/quarto-html/popper.min.js"></script>
<script src="SimulationChallenge_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SimulationChallenge_files/libs/quarto-html/anchor.min.js"></script>
<link href="SimulationChallenge_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SimulationChallenge_files/libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SimulationChallenge_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SimulationChallenge_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SimulationChallenge_files/libs/bootstrap/bootstrap-4d7f0bce1131f3e5f9547cd857cfbfc8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#challenge-overview" id="toc-challenge-overview" class="nav-link active" data-scroll-target="#challenge-overview"><span class="header-section-number">1</span> Challenge Overview</a>
  <ul class="collapse">
  <li><a href="#your-mission" id="toc-your-mission" class="nav-link" data-scroll-target="#your-mission"><span class="header-section-number">1.1</span> Your Mission</a></li>
  <li><a href="#the-investment-game" id="toc-the-investment-game" class="nav-link" data-scroll-target="#the-investment-game"><span class="header-section-number">1.2</span> The Investment Game</a>
  <ul class="collapse">
  <li><a href="#original-game-strategy" id="toc-original-game-strategy" class="nav-link" data-scroll-target="#original-game-strategy"><span class="header-section-number">1.2.1</span> Original Game Strategy</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#setup-and-imports" id="toc-setup-and-imports" class="nav-link" data-scroll-target="#setup-and-imports"><span class="header-section-number">2</span> Setup and Imports</a></li>
  <li><a href="#questions-to-answer-for-75-grade-on-challenge" id="toc-questions-to-answer-for-75-grade-on-challenge" class="nav-link" data-scroll-target="#questions-to-answer-for-75-grade-on-challenge"><span class="header-section-number">3</span> Questions to Answer for 75% Grade on Challenge</a>
  <ul class="collapse">
  <li><a href="#q1-expected-value-analysis" id="toc-q1-expected-value-analysis" class="nav-link" data-scroll-target="#q1-expected-value-analysis"><span class="header-section-number">3.1</span> Q1: Expected Value Analysis</a></li>
  <li><a href="#q2-expectation-vs.-reality" id="toc-q2-expectation-vs.-reality" class="nav-link" data-scroll-target="#q2-expectation-vs.-reality"><span class="header-section-number">3.2</span> Q2: Expectation vs.&nbsp;Reality</a></li>
  <li><a href="#q3-single-simulation" id="toc-q3-single-simulation" class="nav-link" data-scroll-target="#q3-single-simulation"><span class="header-section-number">3.3</span> Q3: Single Simulation</a></li>
  </ul></li>
  <li><a href="#questions-to-answer-for-85-grade-on-challenge" id="toc-questions-to-answer-for-85-grade-on-challenge" class="nav-link" data-scroll-target="#questions-to-answer-for-85-grade-on-challenge"><span class="header-section-number">4</span> Questions to Answer for 85% Grade on Challenge</a>
  <ul class="collapse">
  <li><a href="#q4-multiple-simulations" id="toc-q4-multiple-simulations" class="nav-link" data-scroll-target="#q4-multiple-simulations"><span class="header-section-number">4.1</span> Q4: Multiple Simulations</a></li>
  </ul></li>
  <li><a href="#questions-to-answer-for-95-grade-on-challenge" id="toc-questions-to-answer-for-95-grade-on-challenge" class="nav-link" data-scroll-target="#questions-to-answer-for-95-grade-on-challenge"><span class="header-section-number">5</span> Questions to Answer for 95% Grade on Challenge</a>
  <ul class="collapse">
  <li><a href="#q5-probability-analysis" id="toc-q5-probability-analysis" class="nav-link" data-scroll-target="#q5-probability-analysis"><span class="header-section-number">5.1</span> Q5: Probability Analysis</a></li>
  </ul></li>
  <li><a href="#questions-to-answer-for-100-grade-on-challenge" id="toc-questions-to-answer-for-100-grade-on-challenge" class="nav-link" data-scroll-target="#questions-to-answer-for-100-grade-on-challenge"><span class="header-section-number">6</span> Questions to Answer for 100% Grade on Challenge</a>
  <ul class="collapse">
  <li><a href="#q6-strategy-comparison" id="toc-q6-strategy-comparison" class="nav-link" data-scroll-target="#q6-strategy-comparison"><span class="header-section-number">6.1</span> Q6: Strategy Comparison</a>
  <ul class="collapse">
  <li><a href="#modified-game-strategy" id="toc-modified-game-strategy" class="nav-link" data-scroll-target="#modified-game-strategy"><span class="header-section-number">6.1.1</span> Modified Game Strategy</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">7</span> Conclusion</a></li>
  <li><a href="#challenge-overview-1" id="toc-challenge-overview-1" class="nav-link" data-scroll-target="#challenge-overview-1"><span class="header-section-number">8</span> Challenge Overview</a>
  <ul class="collapse">
  <li><a href="#your-mission-1" id="toc-your-mission-1" class="nav-link" data-scroll-target="#your-mission-1"><span class="header-section-number">8.1</span> Your Mission</a></li>
  <li><a href="#the-investment-game-1" id="toc-the-investment-game-1" class="nav-link" data-scroll-target="#the-investment-game-1"><span class="header-section-number">8.2</span> The Investment Game</a>
  <ul class="collapse">
  <li><a href="#original-game-strategy-1" id="toc-original-game-strategy-1" class="nav-link" data-scroll-target="#original-game-strategy-1"><span class="header-section-number">8.2.1</span> Original Game Strategy</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#setup-and-imports-1" id="toc-setup-and-imports-1" class="nav-link" data-scroll-target="#setup-and-imports-1"><span class="header-section-number">9</span> Setup and Imports</a></li>
  <li><a href="#questions-to-answer-for-75-grade-on-challenge-1" id="toc-questions-to-answer-for-75-grade-on-challenge-1" class="nav-link" data-scroll-target="#questions-to-answer-for-75-grade-on-challenge-1"><span class="header-section-number">10</span> Questions to Answer for 75% Grade on Challenge</a>
  <ul class="collapse">
  <li><a href="#q1-expected-value-analysis-1" id="toc-q1-expected-value-analysis-1" class="nav-link" data-scroll-target="#q1-expected-value-analysis-1"><span class="header-section-number">10.1</span> Q1: Expected Value Analysis</a></li>
  <li><a href="#q2-expectation-vs.-reality-1" id="toc-q2-expectation-vs.-reality-1" class="nav-link" data-scroll-target="#q2-expectation-vs.-reality-1"><span class="header-section-number">10.2</span> Q2: Expectation vs.&nbsp;Reality</a></li>
  <li><a href="#q3-single-simulation-1" id="toc-q3-single-simulation-1" class="nav-link" data-scroll-target="#q3-single-simulation-1"><span class="header-section-number">10.3</span> Q3: Single Simulation</a></li>
  </ul></li>
  <li><a href="#questions-to-answer-for-85-grade-on-challenge-1" id="toc-questions-to-answer-for-85-grade-on-challenge-1" class="nav-link" data-scroll-target="#questions-to-answer-for-85-grade-on-challenge-1"><span class="header-section-number">11</span> Questions to Answer for 85% Grade on Challenge</a>
  <ul class="collapse">
  <li><a href="#q4-multiple-simulations-1" id="toc-q4-multiple-simulations-1" class="nav-link" data-scroll-target="#q4-multiple-simulations-1"><span class="header-section-number">11.1</span> Q4: Multiple Simulations</a></li>
  </ul></li>
  <li><a href="#questions-to-answer-for-95-grade-on-challenge-1" id="toc-questions-to-answer-for-95-grade-on-challenge-1" class="nav-link" data-scroll-target="#questions-to-answer-for-95-grade-on-challenge-1"><span class="header-section-number">12</span> Questions to Answer for 95% Grade on Challenge</a>
  <ul class="collapse">
  <li><a href="#q5-probability-analysis-1" id="toc-q5-probability-analysis-1" class="nav-link" data-scroll-target="#q5-probability-analysis-1"><span class="header-section-number">12.1</span> Q5: Probability Analysis</a></li>
  </ul></li>
  <li><a href="#questions-to-answer-for-100-grade-on-challenge-1" id="toc-questions-to-answer-for-100-grade-on-challenge-1" class="nav-link" data-scroll-target="#questions-to-answer-for-100-grade-on-challenge-1"><span class="header-section-number">13</span> Questions to Answer for 100% Grade on Challenge</a>
  <ul class="collapse">
  <li><a href="#q6-strategy-comparison-1" id="toc-q6-strategy-comparison-1" class="nav-link" data-scroll-target="#q6-strategy-comparison-1"><span class="header-section-number">13.1</span> Q6: Strategy Comparison</a>
  <ul class="collapse">
  <li><a href="#modified-game-strategy-1" id="toc-modified-game-strategy-1" class="nav-link" data-scroll-target="#modified-game-strategy-1"><span class="header-section-number">13.1.1</span> Modified Game Strategy</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion-1" id="toc-conclusion-1" class="nav-link" data-scroll-target="#conclusion-1"><span class="header-section-number">14</span> Conclusion</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Simulation Challenge - Monte Carlo Analysis</h1>
<p class="subtitle lead">Investment Strategy Simulation and Analysis</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Christian Campos </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="challenge-overview" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Challenge Overview</h1>
<section id="your-mission" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="your-mission"><span class="header-section-number">1.1</span> Your Mission</h2>
<p>Create a comprehensive Quarto document that simulates investment strategies, analyzes the results, and demonstrates the ability to present counter-intuitive findings compellingly.</p>
</section>
<section id="the-investment-game" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="the-investment-game"><span class="header-section-number">1.2</span> The Investment Game</h2>
<section id="original-game-strategy" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="original-game-strategy"><span class="header-section-number">1.2.1</span> Original Game Strategy</h3>
<p>Imagine you are offered the following game and given a $1,000 budget in a special account to play the game: - I will flip a coin, and if it comes up heads, we increase your account’s balance by 50% - If it comes up tails, we reduce your account’s balance by 40% - We will do this once per year until you turn 55 - When you turn 55, you will receive the balance in your account</p>
</section>
</section>
</section>
<section id="setup-and-imports" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Setup and Imports</h1>
<div id="c0fe4e3a" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">442</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plotting style</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'default'</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">"husl"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Libraries imported successfully!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Libraries imported successfully!</code></pre>
</div>
</div>
</section>
<section id="questions-to-answer-for-75-grade-on-challenge" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Questions to Answer for 75% Grade on Challenge</h1>
<section id="q1-expected-value-analysis" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="q1-expected-value-analysis"><span class="header-section-number">3.1</span> Q1: Expected Value Analysis</h2>
<p><strong>Question:</strong> What is the “expected value” of your account balance after 1 coin flip for the original game?</p>
<p>Let’s calculate this mathematically and verify with simulation.</p>
<div id="e61f8673" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mathematical calculation</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>initial_balance <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>heads_multiplier <span class="op">=</span> <span class="fl">1.5</span>  <span class="co"># +50%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>tails_multiplier <span class="op">=</span> <span class="fl">0.6</span>  <span class="co"># -40%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>probability <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected value after 1 flip</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>expected_value <span class="op">=</span> probability <span class="op">*</span> (initial_balance <span class="op">*</span> heads_multiplier) <span class="op">+</span> probability <span class="op">*</span> (initial_balance <span class="op">*</span> tails_multiplier)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>expected_gain <span class="op">=</span> expected_value <span class="op">-</span> initial_balance</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Initial balance: $</span><span class="sc">{</span>initial_balance<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Expected value after 1 flip: $</span><span class="sc">{</span>expected_value<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Expected gain: $</span><span class="sc">{</span>expected_gain<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Expected return: </span><span class="sc">{</span>(expected_gain<span class="op">/</span>initial_balance)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initial balance: $1,000
Expected value after 1 flip: $1,050.00
Expected gain: $50.00
Expected return: 5.0%</code></pre>
</div>
</div>
<p><strong>Answer:</strong> The expected value after 1 coin flip is <strong>$1,050</strong>, representing a $50 gain or 5% expected return.</p>
</section>
<section id="q2-expectation-vs.-reality" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="q2-expectation-vs.-reality"><span class="header-section-number">3.2</span> Q2: Expectation vs.&nbsp;Reality</h2>
<p><strong>Question:</strong> Is the expected value positive or negative? Do you expect your account to be worth more or less than $1,000 based on this result?</p>
<div id="8d824965" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's also calculate the geometric mean to understand typical outcomes</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>geometric_mean <span class="op">=</span> (heads_multiplier <span class="op">*</span> tails_multiplier) <span class="op">**</span> <span class="fl">0.5</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>geometric_return <span class="op">=</span> (geometric_mean <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Geometric mean multiplier: </span><span class="sc">{</span>geometric_mean<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Geometric mean return: </span><span class="sc">{</span>geometric_return<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Expected value is positive: </span><span class="sc">{</span>expected_value <span class="op">&gt;</span> initial_balance<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Geometric mean is less than 1: </span><span class="sc">{</span>geometric_mean <span class="op">&lt;</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Geometric mean multiplier: 0.9487
Geometric mean return: -5.13%
Expected value is positive: True
Geometric mean is less than 1: True</code></pre>
</div>
</div>
<p><strong>Analysis:</strong> - The expected value is <strong>positive</strong> ($1,050 &gt; $1,000) - However, the geometric mean is 0.9487, which is <strong>less than 1</strong> - This means while the average outcome is positive, the <strong>typical outcome</strong> will be negative due to volatility drag - Most paths will decline over time despite positive expected value</p>
</section>
<section id="q3-single-simulation" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="q3-single-simulation"><span class="header-section-number">3.3</span> Q3: Single Simulation</h2>
<p><strong>Question:</strong> Run one simulation showing the dynamics of your account balance over time. Make an object-oriented matplotlib plot showing your simulated account balance over time.</p>
<div id="bd01e4e2" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_single_path(initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>, seed<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Simulate a single investment path</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> seed <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        np.random.seed(seed)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    balance <span class="op">=</span> np.zeros(years <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    balance[<span class="dv">0</span>] <span class="op">=</span> initial</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, years <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        coin_flip <span class="op">=</span> np.random.random()</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> coin_flip <span class="op">&lt;</span> <span class="fl">0.5</span>:  <span class="co"># Heads</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>            balance[year] <span class="op">=</span> balance[year<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># Tails</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>            balance[year] <span class="op">=</span> balance[year<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> <span class="fl">0.6</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> balance</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Run single simulation</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>single_path <span class="op">=</span> simulate_single_path(initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>, seed<span class="op">=</span><span class="dv">442</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">56</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create object-oriented matplotlib plot</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>ax.plot(years, single_path, linewidth<span class="op">=</span><span class="dv">2</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>ax.axhline(y<span class="op">=</span><span class="dv">1000</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Initial $1,000'</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Age (Years)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Account Balance ($)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Single Simulation: Account Balance Over Time'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Add final balance annotation</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>final_balance <span class="op">=</span> single_path[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="ss">f'Final: $</span><span class="sc">{</span>final_balance<span class="sc">:,.0f}</span><span class="ss">'</span>, </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>            xy<span class="op">=</span>(<span class="dv">55</span>, final_balance), xytext<span class="op">=</span>(<span class="dv">45</span>, final_balance <span class="op">+</span> <span class="dv">5000</span>),</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, color<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>),</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Final balance after 55 years: $</span><span class="sc">{</span>final_balance<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total return: </span><span class="sc">{</span>((final_balance<span class="op">/</span><span class="dv">1000</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SimulationChallenge_files/figure-html/cell-5-output-1.png" width="1188" height="564" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Final balance after 55 years: $34.89
Total return: -96.5%</code></pre>
</div>
</div>
<p><strong>Commentary:</strong> This single simulation shows the dramatic volatility of the strategy. The path shows how sequences of wins and losses can compound dramatically over time.</p>
</section>
</section>
<section id="questions-to-answer-for-85-grade-on-challenge" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Questions to Answer for 85% Grade on Challenge</h1>
<section id="q4-multiple-simulations" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="q4-multiple-simulations"><span class="header-section-number">4.1</span> Q4: Multiple Simulations</h2>
<p><strong>Question:</strong> Run 100 simulations modeling the dynamics of your account balance over time. Make an object-oriented matplotlib plot showing a probability distribution of the 100 simulated account balances at age 55.</p>
<div id="6d9f13ea" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_multiple_simulations(n_simulations<span class="op">=</span><span class="dv">100</span>, initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Run multiple simulations and return final balances</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    final_balances <span class="op">=</span> np.zeros(n_simulations)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_simulations):</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> simulate_single_path(initial<span class="op">=</span>initial, years<span class="op">=</span>years, seed<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        final_balances[i] <span class="op">=</span> path[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> final_balances</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Run 100 simulations</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>final_balances <span class="op">=</span> run_multiple_simulations(n_simulations<span class="op">=</span><span class="dv">100</span>, initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create distribution plot</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>ax.hist(final_balances, bins<span class="op">=</span><span class="dv">20</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>ax.axvline(<span class="dv">1000</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Initial $1,000'</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>ax.axvline(np.mean(final_balances), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Mean: $</span><span class="sc">{</span>np<span class="sc">.</span>mean(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>ax.axvline(np.median(final_balances), color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Median: $</span><span class="sc">{</span>np<span class="sc">.</span>median(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Final Account Balance ($)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Distribution of Final Account Balances (100 Simulations)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Summary Statistics (100 simulations):"</span>)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean final balance: $</span><span class="sc">{</span>np<span class="sc">.</span>mean(final_balances)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Median final balance: $</span><span class="sc">{</span>np<span class="sc">.</span>median(final_balances)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard deviation: $</span><span class="sc">{</span>np<span class="sc">.</span>std(final_balances)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Minimum final balance: $</span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">min</span>(final_balances)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Maximum final balance: $</span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">max</span>(final_balances)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SimulationChallenge_files/figure-html/cell-6-output-1.png" width="1189" height="588" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Summary Statistics (100 simulations):
Mean final balance: $2,079.51
Median final balance: $34.89
Standard deviation: $13,405.70
Minimum final balance: $0.06
Maximum final balance: $133,094.19</code></pre>
</div>
</div>
<p><strong>Commentary:</strong> The distribution reveals the stark reality of this investment strategy. While the mean is positive due to extreme outliers, the median is much lower, showing that most investors would lose money. The strategy has a “lottery ticket” nature - a few people win big while most lose.</p>
</section>
</section>
<section id="questions-to-answer-for-95-grade-on-challenge" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Questions to Answer for 95% Grade on Challenge</h1>
<section id="q5-probability-analysis" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="q5-probability-analysis"><span class="header-section-number">5.1</span> Q5: Probability Analysis</h2>
<p><strong>Question:</strong> Based on the 100 simulations above, what is the probability that your account balance will be greater than $1,000 at age 55?</p>
<div id="864b4bec" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate probability of ending above $1,000</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>prob_above_1000 <span class="op">=</span> np.mean(final_balances <span class="op">&gt;</span> <span class="dv">1000</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>prob_below_1000 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> prob_above_1000</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary table</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Metric'</span>: [<span class="st">'Probability &gt; $1,000'</span>, <span class="st">'Probability ≤ $1,000'</span>, <span class="st">'Mean Final Balance'</span>, <span class="st">'Median Final Balance'</span>],</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: [<span class="ss">f'</span><span class="sc">{</span>prob_above_1000<span class="sc">:.1%}</span><span class="ss">'</span>, <span class="ss">f'</span><span class="sc">{</span>prob_below_1000<span class="sc">:.1%}</span><span class="ss">'</span>, </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>              <span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>mean(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>, <span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>median(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>]</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Probability Analysis Results:"</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results_df.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional analysis</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Detailed Analysis:"</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Out of 100 simulations:"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(final_balances <span class="op">&gt;</span> <span class="dv">1000</span>)<span class="sc">}</span><span class="ss"> simulations ended above $1,000"</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(final_balances <span class="op">&lt;=</span> <span class="dv">1000</span>)<span class="sc">}</span><span class="ss"> simulations ended at or below $1,000"</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- Success rate: </span><span class="sc">{</span>prob_above_1000<span class="sc">:.1%}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Probability Analysis Results:
              Metric  Value
Probability &gt; $1,000  15.0%
Probability ≤ $1,000  85.0%
  Mean Final Balance $2,080
Median Final Balance    $35

Detailed Analysis:
Out of 100 simulations:
- 15 simulations ended above $1,000
- 85 simulations ended at or below $1,000
- Success rate: 15.0%</code></pre>
</div>
</div>
<p><strong>Answer:</strong> Based on 100 simulations, the probability that the account balance will be greater than $1,000 at age 55 is calculated above.</p>
</section>
</section>
<section id="questions-to-answer-for-100-grade-on-challenge" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Questions to Answer for 100% Grade on Challenge</h1>
<section id="q6-strategy-comparison" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="q6-strategy-comparison"><span class="header-section-number">6.1</span> Q6: Strategy Comparison</h2>
<p><strong>Question:</strong> Run 100 simulations for the modified game strategy. What is the probability that your account balance will be greater than $10,000 at age 55? Is this probability higher or lower than the probability in the original game?</p>
<section id="modified-game-strategy" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="modified-game-strategy"><span class="header-section-number">6.1.1</span> Modified Game Strategy</h3>
<p>In the modified game, you must bet exactly 50% of your current balance each round. The unbet 50% is safe for that round.</p>
<div id="26d1edd6" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_modified_game(initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>, seed<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Simulate the modified game where you bet exactly 50% each round</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> seed <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        np.random.seed(seed)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    balance <span class="op">=</span> np.zeros(years <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    balance[<span class="dv">0</span>] <span class="op">=</span> initial</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, years <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        current_balance <span class="op">=</span> balance[year<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        bet_amount <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> current_balance  <span class="co"># Bet exactly 50%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        safe_amount <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> current_balance  <span class="co"># Keep 50% safe</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        coin_flip <span class="op">=</span> np.random.random()</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> coin_flip <span class="op">&lt;</span> <span class="fl">0.5</span>:  <span class="co"># Heads - bet gains 50%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>            new_bet_value <span class="op">=</span> bet_amount <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># Tails - bet loses 40%</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>            new_bet_value <span class="op">=</span> bet_amount <span class="op">*</span> <span class="fl">0.6</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># New balance = safe amount + new bet value</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        balance[year] <span class="op">=</span> safe_amount <span class="op">+</span> new_bet_value</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> balance</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the modified game calculation</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>test_balance <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>bet <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> test_balance</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>safe <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> test_balance</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Modified Game Logic Verification:"</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Initial balance: $</span><span class="sc">{</span>test_balance<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Bet 50%: $</span><span class="sc">{</span>bet<span class="sc">}</span><span class="ss"> (safe 50%: $</span><span class="sc">{</span>safe<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"If heads: Safe $</span><span class="sc">{</span>safe<span class="sc">}</span><span class="ss"> + Bet $</span><span class="sc">{</span>bet <span class="op">*</span> <span class="fl">1.5</span><span class="sc">}</span><span class="ss"> = $</span><span class="sc">{</span>safe <span class="op">+</span> bet <span class="op">*</span> <span class="fl">1.5</span><span class="sc">}</span><span class="ss"> (1.25x total)"</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"If tails: Safe $</span><span class="sc">{</span>safe<span class="sc">}</span><span class="ss"> + Bet $</span><span class="sc">{</span>bet <span class="op">*</span> <span class="fl">0.6</span><span class="sc">}</span><span class="ss"> = $</span><span class="sc">{</span>safe <span class="op">+</span> bet <span class="op">*</span> <span class="fl">0.6</span><span class="sc">}</span><span class="ss"> (0.8x total)"</span>)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Run 100 simulations of modified game</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>modified_final_balances <span class="op">=</span> np.zeros(<span class="dv">100</span>)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> simulate_modified_game(initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>, seed<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    modified_final_balances[i] <span class="op">=</span> path[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate probabilities</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>prob_modified_above_10k <span class="op">=</span> np.mean(modified_final_balances <span class="op">&gt;</span> <span class="dv">10000</span>)</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>prob_original_above_10k <span class="op">=</span> np.mean(final_balances <span class="op">&gt;</span> <span class="dv">10000</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Strategy Comparison Results:"</span>)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Original game - Probability &gt; $10,000: </span><span class="sc">{</span>prob_original_above_10k<span class="sc">:.1%}</span><span class="ss">"</span>)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Modified game - Probability &gt; $10,000: </span><span class="sc">{</span>prob_modified_above_10k<span class="sc">:.1%}</span><span class="ss">"</span>)</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Modified game has </span><span class="sc">{</span><span class="st">'higher'</span> <span class="cf">if</span> prob_modified_above_10k <span class="op">&gt;</span> prob_original_above_10k <span class="cf">else</span> <span class="st">'lower'</span><span class="sc">}</span><span class="ss"> probability of exceeding $10,000"</span>)</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison plot</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Original game distribution</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>ax1.hist(final_balances, bins<span class="op">=</span><span class="dv">20</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>ax1.axvline(<span class="dv">10000</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'$10,000 target'</span>)</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Final Balance ($)'</span>)</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Density'</span>)</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Original Game: Distribution of Final Balances'</span>)</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>ax1.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Modified game distribution</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>ax2.hist(modified_final_balances, bins<span class="op">=</span><span class="dv">20</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>ax2.axvline(<span class="dv">10000</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'$10,000 target'</span>)</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Final Balance ($)'</span>)</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Density'</span>)</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Modified Game: Distribution of Final Balances'</span>)</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>ax2.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary comparison table</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Strategy'</span>: [<span class="st">'Original Game'</span>, <span class="st">'Modified Game'</span>],</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mean Final Balance'</span>: [<span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>mean(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>, <span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>mean(modified_final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>],</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Median Final Balance'</span>: [<span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>median(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>, <span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>median(modified_final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>],</span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">'P(&gt; $1,000)'</span>: [<span class="ss">f'</span><span class="sc">{</span>np<span class="sc">.</span>mean(final_balances <span class="op">&gt;</span> <span class="dv">1000</span>)<span class="sc">:.1%}</span><span class="ss">'</span>, <span class="ss">f'</span><span class="sc">{</span>np<span class="sc">.</span>mean(modified_final_balances <span class="op">&gt;</span> <span class="dv">1000</span>)<span class="sc">:.1%}</span><span class="ss">'</span>],</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">'P(&gt; $10,000)'</span>: [<span class="ss">f'</span><span class="sc">{</span>prob_original_above_10k<span class="sc">:.1%}</span><span class="ss">'</span>, <span class="ss">f'</span><span class="sc">{</span>prob_modified_above_10k<span class="sc">:.1%}</span><span class="ss">'</span>]</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Detailed Strategy Comparison:"</span>)</span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(comparison_df.to_string(index<span class="op">=</span><span class="va">False</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modified Game Logic Verification:
Initial balance: $1000
Bet 50%: $500.0 (safe 50%: $500.0)
If heads: Safe $500.0 + Bet $750.0 = $1250.0 (1.25x total)
If tails: Safe $500.0 + Bet $300.0 = $800.0 (0.8x total)

Strategy Comparison Results:
Original game - Probability &gt; $10,000: 2.0%
Modified game - Probability &gt; $10,000: 12.0%
Modified game has higher probability of exceeding $10,000</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SimulationChallenge_files/figure-html/cell-8-output-2.png" width="1486" height="588" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Detailed Strategy Comparison:
     Strategy Mean Final Balance Median Final Balance P(&gt; $1,000) P(&gt; $10,000)
Original Game             $2,080                  $35       15.0%         2.0%
Modified Game             $4,028               $1,025       50.0%        12.0%</code></pre>
</div>
</div>
<p><strong>Answer:</strong> The results show the probability calculations for both strategies exceeding $10,000, with a comparison of which strategy performs better.</p>
<p><strong>Analysis:</strong> The modified game is significantly more conservative and reliable. By betting only 50% each round, it reduces volatility while maintaining positive expected returns, making it much more likely to achieve substantial gains.</p>
</section>
</section>
</section>
<section id="conclusion" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Conclusion</h1>
<p>This simulation challenge demonstrates several key investment principles:</p>
<ol type="1">
<li><strong>Expected value vs.&nbsp;typical outcomes:</strong> Positive expected returns don’t guarantee positive typical outcomes</li>
<li><strong>Volatility drag:</strong> High volatility can erode wealth even with positive expected returns</li>
<li><strong>Risk management:</strong> Conservative strategies (like the modified game) can outperform aggressive ones</li>
<li><strong>The power of diversification:</strong> Keeping some capital safe each round significantly improves outcomes</li>
</ol>
<p>The modified game strategy proves that sometimes “boring” investing can be more effective than high-risk, high-reward strategies.</p>
</section>
<section id="challenge-overview-1" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Challenge Overview</h1>
<section id="your-mission-1" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="your-mission-1"><span class="header-section-number">8.1</span> Your Mission</h2>
<p>Create a comprehensive Quarto document that simulates investment strategies, analyzes the results, and demonstrates the ability to present counter-intuitive findings compellingly.</p>
</section>
<section id="the-investment-game-1" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="the-investment-game-1"><span class="header-section-number">8.2</span> The Investment Game</h2>
<section id="original-game-strategy-1" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="original-game-strategy-1"><span class="header-section-number">8.2.1</span> Original Game Strategy</h3>
<p>Imagine you are offered the following game and given a $1,000 budget in a special account to play the game: - I will flip a coin, and if it comes up heads, we increase your account’s balance by 50% - If it comes up tails, we reduce your account’s balance by 40% - We will do this once per year until you turn 55 - When you turn 55, you will receive the balance in your account</p>
</section>
</section>
</section>
<section id="setup-and-imports-1" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Setup and Imports</h1>
<div id="be4ba183" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">442</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plotting style</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'default'</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">"husl"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Libraries imported successfully!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Libraries imported successfully!</code></pre>
</div>
</div>
</section>
<section id="questions-to-answer-for-75-grade-on-challenge-1" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Questions to Answer for 75% Grade on Challenge</h1>
<section id="q1-expected-value-analysis-1" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="q1-expected-value-analysis-1"><span class="header-section-number">10.1</span> Q1: Expected Value Analysis</h2>
<p><strong>Question:</strong> What is the “expected value” of your account balance after 1 coin flip for the original game?</p>
<p>Let’s calculate this mathematically and verify with simulation.</p>
<div id="d3d1b3db" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mathematical calculation</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>initial_balance <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>heads_multiplier <span class="op">=</span> <span class="fl">1.5</span>  <span class="co"># +50%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>tails_multiplier <span class="op">=</span> <span class="fl">0.6</span>  <span class="co"># -40%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>probability <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected value after 1 flip</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>expected_value <span class="op">=</span> probability <span class="op">*</span> (initial_balance <span class="op">*</span> heads_multiplier) <span class="op">+</span> probability <span class="op">*</span> (initial_balance <span class="op">*</span> tails_multiplier)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>expected_gain <span class="op">=</span> expected_value <span class="op">-</span> initial_balance</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Initial balance: $</span><span class="sc">{</span>initial_balance<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Expected value after 1 flip: $</span><span class="sc">{</span>expected_value<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Expected gain: $</span><span class="sc">{</span>expected_gain<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Expected return: </span><span class="sc">{</span>(expected_gain<span class="op">/</span>initial_balance)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initial balance: $1,000
Expected value after 1 flip: $1,050.00
Expected gain: $50.00
Expected return: 5.0%</code></pre>
</div>
</div>
<p><strong>Answer:</strong> The expected value after 1 coin flip is <strong>$1,050</strong>, representing a $50 gain or 5% expected return.</p>
</section>
<section id="q2-expectation-vs.-reality-1" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="q2-expectation-vs.-reality-1"><span class="header-section-number">10.2</span> Q2: Expectation vs.&nbsp;Reality</h2>
<p><strong>Question:</strong> Is the expected value positive or negative? Do you expect your account to be worth more or less than $1,000 based on this result?</p>
<div id="953f51c1" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's also calculate the geometric mean to understand typical outcomes</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>geometric_mean <span class="op">=</span> (heads_multiplier <span class="op">*</span> tails_multiplier) <span class="op">**</span> <span class="fl">0.5</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>geometric_return <span class="op">=</span> (geometric_mean <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Geometric mean multiplier: </span><span class="sc">{</span>geometric_mean<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Geometric mean return: </span><span class="sc">{</span>geometric_return<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Expected value is positive: </span><span class="sc">{</span>expected_value <span class="op">&gt;</span> initial_balance<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Geometric mean is less than 1: </span><span class="sc">{</span>geometric_mean <span class="op">&lt;</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Geometric mean multiplier: 0.9487
Geometric mean return: -5.13%
Expected value is positive: True
Geometric mean is less than 1: True</code></pre>
</div>
</div>
<p><strong>Analysis:</strong> - The expected value is <strong>positive</strong> ($1,050 &gt; $1,000) - However, the geometric mean is 0.9487, which is <strong>less than 1</strong> - This means while the average outcome is positive, the <strong>typical outcome</strong> will be negative due to volatility drag - Most paths will decline over time despite positive expected value</p>
</section>
<section id="q3-single-simulation-1" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="q3-single-simulation-1"><span class="header-section-number">10.3</span> Q3: Single Simulation</h2>
<p><strong>Question:</strong> Run one simulation showing the dynamics of your account balance over time. Make an object-oriented matplotlib plot showing your simulated account balance over time.</p>
<div id="c59a984e" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_single_path(initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>, seed<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Simulate a single investment path</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> seed <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        np.random.seed(seed)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    balance <span class="op">=</span> np.zeros(years <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    balance[<span class="dv">0</span>] <span class="op">=</span> initial</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, years <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        coin_flip <span class="op">=</span> np.random.random()</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> coin_flip <span class="op">&lt;</span> <span class="fl">0.5</span>:  <span class="co"># Heads</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>            balance[year] <span class="op">=</span> balance[year<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># Tails</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>            balance[year] <span class="op">=</span> balance[year<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> <span class="fl">0.6</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> balance</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Run single simulation</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>single_path <span class="op">=</span> simulate_single_path(initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>, seed<span class="op">=</span><span class="dv">442</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">56</span>)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create object-oriented matplotlib plot</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>ax.plot(years, single_path, linewidth<span class="op">=</span><span class="dv">2</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>ax.axhline(y<span class="op">=</span><span class="dv">1000</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Initial $1,000'</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Age (Years)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Account Balance ($)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Single Simulation: Account Balance Over Time'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Add final balance annotation</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>final_balance <span class="op">=</span> single_path[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="ss">f'Final: $</span><span class="sc">{</span>final_balance<span class="sc">:,.0f}</span><span class="ss">'</span>, </span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>            xy<span class="op">=</span>(<span class="dv">55</span>, final_balance), xytext<span class="op">=</span>(<span class="dv">45</span>, final_balance <span class="op">+</span> <span class="dv">5000</span>),</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, color<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>),</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Final balance after 55 years: $</span><span class="sc">{</span>final_balance<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total return: </span><span class="sc">{</span>((final_balance<span class="op">/</span><span class="dv">1000</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SimulationChallenge_files/figure-html/cell-12-output-1.png" width="1188" height="564" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Final balance after 55 years: $34.89
Total return: -96.5%</code></pre>
</div>
</div>
<p><strong>Commentary:</strong> This single simulation shows the dramatic volatility of the strategy. Starting at $1,000, the account reached a final balance of ${final_balance:,.0f}. The path shows how sequences of wins and losses can compound dramatically over time.</p>
</section>
</section>
<section id="questions-to-answer-for-85-grade-on-challenge-1" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Questions to Answer for 85% Grade on Challenge</h1>
<section id="q4-multiple-simulations-1" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="q4-multiple-simulations-1"><span class="header-section-number">11.1</span> Q4: Multiple Simulations</h2>
<p><strong>Question:</strong> Run 100 simulations modeling the dynamics of your account balance over time. Make an object-oriented matplotlib plot showing a probability distribution of the 100 simulated account balances at age 55.</p>
<div id="44d507ae" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_multiple_simulations(n_simulations<span class="op">=</span><span class="dv">100</span>, initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Run multiple simulations and return final balances</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    final_balances <span class="op">=</span> np.zeros(n_simulations)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_simulations):</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> simulate_single_path(initial<span class="op">=</span>initial, years<span class="op">=</span>years, seed<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        final_balances[i] <span class="op">=</span> path[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> final_balances</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Run 100 simulations</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>final_balances <span class="op">=</span> run_multiple_simulations(n_simulations<span class="op">=</span><span class="dv">100</span>, initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create distribution plot</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>ax.hist(final_balances, bins<span class="op">=</span><span class="dv">20</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>ax.axvline(<span class="dv">1000</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Initial $1,000'</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>ax.axvline(np.mean(final_balances), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Mean: $</span><span class="sc">{</span>np<span class="sc">.</span>mean(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>ax.axvline(np.median(final_balances), color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Median: $</span><span class="sc">{</span>np<span class="sc">.</span>median(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Final Account Balance ($)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Distribution of Final Account Balances (100 Simulations)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Summary Statistics (100 simulations):"</span>)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean final balance: $</span><span class="sc">{</span>np<span class="sc">.</span>mean(final_balances)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Median final balance: $</span><span class="sc">{</span>np<span class="sc">.</span>median(final_balances)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard deviation: $</span><span class="sc">{</span>np<span class="sc">.</span>std(final_balances)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Minimum final balance: $</span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">min</span>(final_balances)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Maximum final balance: $</span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">max</span>(final_balances)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SimulationChallenge_files/figure-html/cell-13-output-1.png" width="1189" height="588" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Summary Statistics (100 simulations):
Mean final balance: $2,079.51
Median final balance: $34.89
Standard deviation: $13,405.70
Minimum final balance: $0.06
Maximum final balance: $133,094.19</code></pre>
</div>
</div>
<p><strong>Commentary:</strong> The distribution reveals the stark reality of this investment strategy. While the mean is positive due to extreme outliers, the median is much lower, showing that most investors would lose money. The strategy has a “lottery ticket” nature - a few people win big while most lose.</p>
</section>
</section>
<section id="questions-to-answer-for-95-grade-on-challenge-1" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Questions to Answer for 95% Grade on Challenge</h1>
<section id="q5-probability-analysis-1" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="q5-probability-analysis-1"><span class="header-section-number">12.1</span> Q5: Probability Analysis</h2>
<p><strong>Question:</strong> Based on the 100 simulations above, what is the probability that your account balance will be greater than $1,000 at age 55?</p>
<div id="3820638e" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate probability of ending above $1,000</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>prob_above_1000 <span class="op">=</span> np.mean(final_balances <span class="op">&gt;</span> <span class="dv">1000</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>prob_below_1000 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> prob_above_1000</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary table</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Metric'</span>: [<span class="st">'Probability &gt; $1,000'</span>, <span class="st">'Probability ≤ $1,000'</span>, <span class="st">'Mean Final Balance'</span>, <span class="st">'Median Final Balance'</span>],</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: [<span class="ss">f'</span><span class="sc">{</span>prob_above_1000<span class="sc">:.1%}</span><span class="ss">'</span>, <span class="ss">f'</span><span class="sc">{</span>prob_below_1000<span class="sc">:.1%}</span><span class="ss">'</span>, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>              <span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>mean(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>, <span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>median(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>]</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Probability Analysis Results:"</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results_df.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional analysis</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Detailed Analysis:"</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Out of 100 simulations:"</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(final_balances <span class="op">&gt;</span> <span class="dv">1000</span>)<span class="sc">}</span><span class="ss"> simulations ended above $1,000"</span>)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(final_balances <span class="op">&lt;=</span> <span class="dv">1000</span>)<span class="sc">}</span><span class="ss"> simulations ended at or below $1,000"</span>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- Success rate: </span><span class="sc">{</span>prob_above_1000<span class="sc">:.1%}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Probability Analysis Results:
              Metric  Value
Probability &gt; $1,000  15.0%
Probability ≤ $1,000  85.0%
  Mean Final Balance $2,080
Median Final Balance    $35

Detailed Analysis:
Out of 100 simulations:
- 15 simulations ended above $1,000
- 85 simulations ended at or below $1,000
- Success rate: 15.0%</code></pre>
</div>
</div>
<p><strong>Answer:</strong> Based on 100 simulations, the probability that the account balance will be greater than $1,000 at age 55 is <strong>{prob_above_1000:.1%}</strong>.</p>
</section>
</section>
<section id="questions-to-answer-for-100-grade-on-challenge-1" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Questions to Answer for 100% Grade on Challenge</h1>
<section id="q6-strategy-comparison-1" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="q6-strategy-comparison-1"><span class="header-section-number">13.1</span> Q6: Strategy Comparison</h2>
<p><strong>Question:</strong> Run 100 simulations for the modified game strategy. What is the probability that your account balance will be greater than $10,000 at age 55? Is this probability higher or lower than the probability in the original game?</p>
<section id="modified-game-strategy-1" class="level3" data-number="13.1.1">
<h3 data-number="13.1.1" class="anchored" data-anchor-id="modified-game-strategy-1"><span class="header-section-number">13.1.1</span> Modified Game Strategy</h3>
<p>In the modified game, you must bet exactly 50% of your current balance each round. The unbet 50% is safe for that round.</p>
<div id="cf6a5f31" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_modified_game(initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>, seed<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Simulate the modified game where you bet exactly 50% each round</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> seed <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        np.random.seed(seed)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    balance <span class="op">=</span> np.zeros(years <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    balance[<span class="dv">0</span>] <span class="op">=</span> initial</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, years <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        current_balance <span class="op">=</span> balance[year<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        bet_amount <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> current_balance  <span class="co"># Bet exactly 50%</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        safe_amount <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> current_balance  <span class="co"># Keep 50% safe</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        coin_flip <span class="op">=</span> np.random.random()</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> coin_flip <span class="op">&lt;</span> <span class="fl">0.5</span>:  <span class="co"># Heads - bet gains 50%</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>            new_bet_value <span class="op">=</span> bet_amount <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># Tails - bet loses 40%</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>            new_bet_value <span class="op">=</span> bet_amount <span class="op">*</span> <span class="fl">0.6</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># New balance = safe amount + new bet value</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        balance[year] <span class="op">=</span> safe_amount <span class="op">+</span> new_bet_value</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> balance</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the modified game calculation</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>test_balance <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>bet <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> test_balance</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>safe <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> test_balance</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Modified Game Logic Verification:"</span>)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Initial balance: $</span><span class="sc">{</span>test_balance<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Bet 50%: $</span><span class="sc">{</span>bet<span class="sc">}</span><span class="ss"> (safe 50%: $</span><span class="sc">{</span>safe<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"If heads: Safe $</span><span class="sc">{</span>safe<span class="sc">}</span><span class="ss"> + Bet $</span><span class="sc">{</span>bet <span class="op">*</span> <span class="fl">1.5</span><span class="sc">}</span><span class="ss"> = $</span><span class="sc">{</span>safe <span class="op">+</span> bet <span class="op">*</span> <span class="fl">1.5</span><span class="sc">}</span><span class="ss"> (1.25x total)"</span>)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"If tails: Safe $</span><span class="sc">{</span>safe<span class="sc">}</span><span class="ss"> + Bet $</span><span class="sc">{</span>bet <span class="op">*</span> <span class="fl">0.6</span><span class="sc">}</span><span class="ss"> = $</span><span class="sc">{</span>safe <span class="op">+</span> bet <span class="op">*</span> <span class="fl">0.6</span><span class="sc">}</span><span class="ss"> (0.8x total)"</span>)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Run 100 simulations of modified game</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>modified_final_balances <span class="op">=</span> np.zeros(<span class="dv">100</span>)</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> simulate_modified_game(initial<span class="op">=</span><span class="dv">1000</span>, years<span class="op">=</span><span class="dv">55</span>, seed<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    modified_final_balances[i] <span class="op">=</span> path[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate probabilities</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>prob_modified_above_10k <span class="op">=</span> np.mean(modified_final_balances <span class="op">&gt;</span> <span class="dv">10000</span>)</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>prob_original_above_10k <span class="op">=</span> np.mean(final_balances <span class="op">&gt;</span> <span class="dv">10000</span>)</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Strategy Comparison Results:"</span>)</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Original game - Probability &gt; $10,000: </span><span class="sc">{</span>prob_original_above_10k<span class="sc">:.1%}</span><span class="ss">"</span>)</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Modified game - Probability &gt; $10,000: </span><span class="sc">{</span>prob_modified_above_10k<span class="sc">:.1%}</span><span class="ss">"</span>)</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Modified game has </span><span class="sc">{</span><span class="st">'higher'</span> <span class="cf">if</span> prob_modified_above_10k <span class="op">&gt;</span> prob_original_above_10k <span class="cf">else</span> <span class="st">'lower'</span><span class="sc">}</span><span class="ss"> probability of exceeding $10,000"</span>)</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison plot</span></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Original game distribution</span></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>ax1.hist(final_balances, bins<span class="op">=</span><span class="dv">20</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>ax1.axvline(<span class="dv">10000</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'$10,000 target'</span>)</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Final Balance ($)'</span>)</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Density'</span>)</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Original Game: Distribution of Final Balances'</span>)</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>ax1.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Modified game distribution</span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>ax2.hist(modified_final_balances, bins<span class="op">=</span><span class="dv">20</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>ax2.axvline(<span class="dv">10000</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'$10,000 target'</span>)</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Final Balance ($)'</span>)</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Density'</span>)</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Modified Game: Distribution of Final Balances'</span>)</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>ax2.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary comparison table</span></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Strategy'</span>: [<span class="st">'Original Game'</span>, <span class="st">'Modified Game'</span>],</span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mean Final Balance'</span>: [<span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>mean(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>, <span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>mean(modified_final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>],</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Median Final Balance'</span>: [<span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>median(final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>, <span class="ss">f'$</span><span class="sc">{</span>np<span class="sc">.</span>median(modified_final_balances)<span class="sc">:,.0f}</span><span class="ss">'</span>],</span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">'P(&gt; $1,000)'</span>: [<span class="ss">f'</span><span class="sc">{</span>np<span class="sc">.</span>mean(final_balances <span class="op">&gt;</span> <span class="dv">1000</span>)<span class="sc">:.1%}</span><span class="ss">'</span>, <span class="ss">f'</span><span class="sc">{</span>np<span class="sc">.</span>mean(modified_final_balances <span class="op">&gt;</span> <span class="dv">1000</span>)<span class="sc">:.1%}</span><span class="ss">'</span>],</span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">'P(&gt; $10,000)'</span>: [<span class="ss">f'</span><span class="sc">{</span>prob_original_above_10k<span class="sc">:.1%}</span><span class="ss">'</span>, <span class="ss">f'</span><span class="sc">{</span>prob_modified_above_10k<span class="sc">:.1%}</span><span class="ss">'</span>]</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Detailed Strategy Comparison:"</span>)</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(comparison_df.to_string(index<span class="op">=</span><span class="va">False</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modified Game Logic Verification:
Initial balance: $1000
Bet 50%: $500.0 (safe 50%: $500.0)
If heads: Safe $500.0 + Bet $750.0 = $1250.0 (1.25x total)
If tails: Safe $500.0 + Bet $300.0 = $800.0 (0.8x total)

Strategy Comparison Results:
Original game - Probability &gt; $10,000: 2.0%
Modified game - Probability &gt; $10,000: 12.0%
Modified game has higher probability of exceeding $10,000</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SimulationChallenge_files/figure-html/cell-15-output-2.png" width="1486" height="588" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Detailed Strategy Comparison:
     Strategy Mean Final Balance Median Final Balance P(&gt; $1,000) P(&gt; $10,000)
Original Game             $2,080                  $35       15.0%         2.0%
Modified Game             $4,028               $1,025       50.0%        12.0%</code></pre>
</div>
</div>
<p><strong>Answer:</strong> - <strong>Modified game probability &gt; $10,000:</strong> {prob_modified_above_10k:.1%} - <strong>Original game probability &gt; $10,000:</strong> {prob_original_above_10k:.1%} - The modified game has a <strong>{(‘higher’ if prob_modified_above_10k &gt; prob_original_above_10k else ‘lower’)}</strong> probability of exceeding $10,000</p>
<p><strong>Analysis:</strong> The modified game is significantly more conservative and reliable. By betting only 50% each round, it reduces volatility while maintaining positive expected returns, making it much more likely to achieve substantial gains.</p>
</section>
</section>
</section>
<section id="conclusion-1" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Conclusion</h1>
<p>This simulation challenge demonstrates several key investment principles:</p>
<ol type="1">
<li><strong>Expected value vs.&nbsp;typical outcomes:</strong> Positive expected returns don’t guarantee positive typical outcomes</li>
<li><strong>Volatility drag:</strong> High volatility can erode wealth even with positive expected returns</li>
<li><strong>Risk management:</strong> Conservative strategies (like the modified game) can outperform aggressive ones</li>
<li><strong>The power of diversification:</strong> Keeping some capital safe each round significantly improves outcomes</li>
</ol>
<p>The modified game strategy proves that sometimes “boring” investing can be more effective than high-risk, high-reward strategies.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>